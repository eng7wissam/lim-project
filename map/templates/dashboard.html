{% extends 'base.html' %}
{% block body %}
{% include 'status.html' %}


<div class="row">
    <div class="col-md-5">
        <h5> Applicants </h5>
        <hr>
        <div class="card card-body">
            <a class="btn btn-primary btn-sm btn-block" href="">Create Applicant</a>
            <table class="table table-sm">
                <tr>
                    <th> </th>
                    <th> Name</th>
                    <th> Nation</th>
                    <th>Project Name</th>
                </tr>
                {% for applicant in applicants %}
                <tr>
                    <td><a class="btn btn-sm btn-info" href="{% url 'prj' applicant.project.id %}">View</a></td>
                    <td>{{applicant.person}} </td>
                    <td>{{applicant.nation}} </td>
                    <td>{{applicant.project}} </td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <div class="col-md-7">
        <h5> Investors </h5>
        <hr>
        <div class="card card-body">
            <a class="btn btn-primary btn-sm btn-block" href="{% url 'create_investor' %}">Create Investor</a>
            <table class="table table-sm">
                <tr>
                    <th></th>
                    <th>Investor Name</th>
                    <th> Nation </th>
                    <th> Project Name </th>

                </tr>
                {% for investor in investors %}
                <tr>
                    <td><a class="btn btn-sm btn-info" href="{% url 'prj' investor.id %}">View</a></td>
                    <td>{{investor.name}} </td>
                    <td>{{investor.nation}} </td>
                    <td>{{investor.project}} </td>

                    <td><a class="btn btn-outline-info btn-sm btn-block"
                            href="{% url 'update_investor' investor.id %}">Update</a></td>
                    <td><a class="btn btn-outline-danger btn-sm btn-block"
                            href="{% url 'delete_investor' investor.id %}">Delete</a></td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

{% block script %}
<div class="row">
    <div class="col-md-5">
        <div class="card card-body">

            <div id="map" style="height: 50px; width: 600px;">
                <script type="text/javascript">
                    function out_layers(map, options) {
                        var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                            maxZoom: 19,
                            attribution: '© OpenStreetMap'
                        });

                        var osmHOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
                            maxZoom: 19,
                            attribution: '© OpenStreetMap contributors, Tiles style by Humanitarian OpenStreetMap Team hosted by OpenStreetMap France'
                        });
                        var openTopoMap = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
                            maxZoom: 19,
                            attribution: 'Map data: © OpenStreetMap contributors, SRTM | Map style: © OpenTopoMap (CC-BY-SA)'
                        });

                        var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
                            maxZoom: 20,
                            subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
                        });
                        // googleSat.addTo(pibMap);

                        var googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
                            maxZoom: 20,
                            subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
                        });

                        var datasets = new L.GeoJSON.AJAX("{% url 'city' %}", {
                            style: function colors(feature) {
                                switch (feature.properties.pk) {
                                    case '1':
                                        return {
                                            radius: 8,
                                            fillColor: 'blue',
                                            weight: 2,
                                            opacity: 1,
                                            color: 'orange',
                                            fillOpacity: 0.7
                                        };
                                        break;
                                    case '2':
                                        return {
                                            fillColor: '#285078',
                                            weight: 2,
                                            opacity: 1,
                                            color: 'orange',
                                            fillOpacity: 0.7
                                        };
                                        break;
                                    case '3':
                                        return {
                                            fillColor: '#a0c8f0',
                                            weight: 2,
                                            opacity: 1,
                                            color: 'orange',
                                            fillOpacity: 0.7
                                        };
                                        break;
                                    case '4':
                                        return {
                                            fillColor: '#FCF3CF ',
                                            weight: 2,
                                            opacity: 1,
                                            color: 'orange',
                                            fillOpacity: 0.7
                                        };
                                        break;
                                }
                            },
                            onEachFeature: function (feature, layer) {
                                layer.bindPopup(feature.properties.name_ar.toString());
                            }
                        });

                        var points = new L.GeoJSON.AJAX("{% url 'projects_data' %}", {
                            onEachFeature: function (feature, layer) {
                                layer.bindPopup(feature.properties.proj_name.toString());
                            }
                        });

                        datasets.addTo(map);
                        points.addTo(map);

                        var baseMaps = {
                            "OpenStreetMap": osm,
                            "OpenStreetMap.HOT": osmHOT,
                            "openTopoMap": openTopoMap,
                            "Satallite": googleSat,
                            "googleHybrid": googleHybrid,

                        };

                        var overlayMaps = {
                            "region": datasets,
                            "project_na": points,
                        };
                        var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);
                    }
                </script>
            </div>
        </div>
    </div>
</div>
{% endblock script %}

{% endblock body %}